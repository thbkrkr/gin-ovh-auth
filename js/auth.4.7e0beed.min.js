(function(){AUTH_LOADER_ELEM_ID="loader";AUTH_LOGIN_ELEM_ID="login";AUTH_LOGOUT_ELEM_ID="logout";"undefined"===typeof AUTH_CREDS_URL&&(AUTH_CREDS_URL="/auth/credential");"undefined"===typeof AUTH_VALIDATION_URL&&(AUTH_VALIDATION_URL="/auth/validate/");"undefined"===typeof AUTH_LOCAL_STORAGE_KEY&&(AUTH_LOCAL_STORAGE_KEY="auth");"undefined"===typeof TOKEN_LOCAL_STORAGE_KEY&&(TOKEN_LOCAL_STORAGE_KEY="token");"undefined"===typeof AUTH_HOME_PATH&&(AUTH_HOME_PATH="/s/");"undefined"===typeof AUTH_LOGIN_PATH&&
(AUTH_LOGIN_PATH="/s/login.html");window.addEventListener("load",function(){loaderElem=document.getElementById(AUTH_LOADER_ELEM_ID);loginElem=document.getElementById(AUTH_LOGIN_ELEM_ID);logoutElem=document.getElementById(AUTH_LOGOUT_ELEM_ID);localStorage.getItem(AUTH_LOCAL_STORAGE_KEY)&&window.location.pathname!=AUTH_HOME_PATH?window.location=AUTH_HOME_PATH:(validateToken=!1,(token=localStorage.getItem(TOKEN_LOCAL_STORAGE_KEY)||$param("token"))?(loaderElem&&(loaderElem.style.display="inline-block"),
validateToken=!0,$get(AUTH_VALIDATION_URL+token,function(a){localStorage.removeItem(TOKEN_LOCAL_STORAGE_KEY);localStorage.setItem(AUTH_LOCAL_STORAGE_KEY,a.auth);window.location=AUTH_HOME_PATH},function(a){localStorage.removeItem(TOKEN_LOCAL_STORAGE_KEY);window.location=AUTH_LOGIN_PATH})):(loginElem&&!validateToken&&(loaderElem&&(loaderElem.style.display="none"),loginElem.innerHTML="Login",loginElem.style.display="inline-block",loginElem.addEventListener("click",function(){loginElem.style.display=
"none";loaderElem&&(loaderElem.style.display="inline-block");home=window.location.origin+AUTH_LOGIN_PATH;$get(AUTH_CREDS_URL+"?redirect="+home,function(a){localStorage.setItem(TOKEN_LOCAL_STORAGE_KEY,a.token);window.location=a.url},function(a){window.location=AUTH_LOGIN_PATH})})),logoutElem&&logoutElem.addEventListener("click",function(){localStorage.removeItem(AUTH_LOCAL_STORAGE_KEY);window.location=AUTH_LOGIN_PATH})))})})();
