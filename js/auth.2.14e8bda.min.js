(function(){AUTH_LOADER_ELEM_ID="loader";AUTH_LOGIN_ELEM_ID="login";AUTH_LOGOUT_ELEM_ID="logout";AUTH_CREDS_URL="/auth/credential";AUTH_VALIDATION_URL="/auth/validate/";AUTH_LOCAL_STORAGE_KEY="auth";DEFAULT_AUTH_HOME_PATH="/s/";DEFAULT_AUTH_LOGIN_PATH="/s/login.html";"undefined"===typeof AUTH_HOME_PATH&&(AUTH_HOME_PATH=DEFAULT_AUTH_HOME_PATH);"undefined"===typeof AUTH_LOGIN_PATH&&(AUTH_LOGIN_PATH=DEFAULT_AUTH_LOGIN_PATH);window.addEventListener("load",function(){loaderElem=document.getElementById(AUTH_LOADER_ELEM_ID);
loginElem=document.getElementById(AUTH_LOGIN_ELEM_ID);logoutElem=document.getElementById(AUTH_LOGOUT_ELEM_ID);localStorage.getItem(AUTH_LOCAL_STORAGE_KEY)&&window.location.pathname!=AUTH_HOME_PATH?window.location=AUTH_HOME_PATH:(validateToken=!1,(token=$param("token"))?(loaderElem&&(loaderElem.style.display="inline-block"),validateToken=!0,$get(AUTH_VALIDATION_URL+token,function(a){localStorage.setItem(AUTH_LOCAL_STORAGE_KEY,a.auth);window.location=AUTH_HOME_PATH},function(a){window.location=AUTH_LOGIN_PATH})):
(loginElem&&!validateToken&&(loaderElem&&(loaderElem.style.display="none"),loginElem.innerHTML="Login",loginElem.style.display="inline-block",loginElem.addEventListener("click",function(){loginElem.style.display="none";loaderElem&&(loaderElem.style.display="inline-block");home=window.location.origin+AUTH_LOGIN_PATH;$get(AUTH_CREDS_URL+"?redirect="+home,function(a){window.location=a.url},function(a){window.location=AUTH_LOGIN_PATH})})),logoutElem&&logoutElem.addEventListener("click",function(){localStorage.removeItem(AUTH_LOCAL_STORAGE_KEY);
window.location=AUTH_LOGIN_PATH})))})})();
